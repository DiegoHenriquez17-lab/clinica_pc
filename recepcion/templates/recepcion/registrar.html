{# templates/recepcion/registrar.html #}
{% extends "base.html" %}
{% block title %}Registrar equipo · Clínica PC{% endblock %}
{% block page_title %}Recepción · Registrar equipo{% endblock %}
{% block content %}
<form method="post" class="row g-3">
  {% csrf_token %}
  {% if confirm_duplicate %}
    <div class="col-12">
      <div class="alert alert-warning">
        <strong>Atención:</strong> Ya existe un registro para <strong>{{ nombre }}</strong>.
        ¿Deseas agregar un nuevo ingreso para otra revisión del equipo?
      </div>
    </div>
  {% endif %}
  <div class="col-md-6">
    <label class="form-label">Estudiante</label>
    <select name="nombre" class="form-select" required>
      <option value="" selected disabled>Selecciona…</option>
      {% for est in estudiantes %}
        <option value="{{ est }}" {% if nombre == est %}selected{% endif %}>{{ est }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-6">
    <label class="form-label">RUT</label>
    <input type="text" name="rut" class="form-control" value="{{ rut|default:'' }}" placeholder="12.345.678-9">
  </div>
  <div class="col-md-6">
    <label class="form-label">Tipo de equipo</label>
    <select name="tipo_equipo" class="form-select" required>
      <option value="" selected disabled>Selecciona…</option>
      {% for t in tipos_equipos %}
        <option value="{{ t }}" {% if tipo_equipo == t %}selected{% endif %}>{{ t }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-6">
    <label class="form-label">Correo electrónico</label>
    <input type="email" name="correo" class="form-control" value="{{ correo|default:'' }}" placeholder="usuario@dominio.cl">
  </div>
  <div class="col-12">
    <label class="form-label">Descripción del problema</label>
    <textarea name="problema" class="form-control" rows="3" required>{{ problema }}</textarea>
  </div>
  <div class="col-md-6">
    <label class="form-label">Teléfono</label>
    <input type="text" name="telefono" class="form-control" value="{{ telefono|default:'' }}" placeholder="+56 9 1234 5678">
  </div>
  <div class="col-12 d-flex justify-content-end gap-2">
    <a class="btn btn-outline-secondary" href="{% url 'recepcion:listado' %}">Ver listado</a>
    {% if confirm_duplicate %}
      <input type="hidden" name="confirm_duplicate" value="1">
      <button class="btn btn-primary">Confirmar y Registrar</button>
    {% else %}
      <button class="btn btn-primary">Registrar</button>
    {% endif %}
  </div>
</form>
{% endblock %}
